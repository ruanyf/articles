# 微服务是什么？

微服务（microservice）是一种软件架构，正得到越来越多的关注。

但是，它到底是什么意思？什么样的架构可以叫做微服务？

网上的文章虽然很多，但是都太复杂，初学者不容易看懂。我认为，这个概念其实非常简单，可以很通俗地说明白。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042801.webp)

## 一、单体软件

要理解微服务，首先需要理解软件架构的演变。

早期的软件，所有功能都写在一起，这称为**单体架构**（monolithic software）。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042802.webp)

整个软件就是单一的整体，彷佛一体化的机器。

可以想到，软件的功能越多，单体架构就会越复杂，很多缺点也随之暴露出来。

> （1）所有功能耦合在一起，互相影响，最终难以管理。
>
> （2）哪怕只修改一行代码，整个软件就要重新构建和部署，成本非常高。
>
> （3）因为软件做成了一个整体，不可能每个功能单独开发和测试，只能整体开发和测试，导致必须采用瀑布式开发模型。

以上三个原因的详细分析，可以参考我以前的文章[《软件工程的最大难题》](https://www.ruanyifeng.com/blog/2021/05/scaling-problem.html)。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042803.webp)

总之，单体架构的大型软件，不仅开发速度慢，而且会形成难以维护和升级的复杂代码，成为程序员的沉重负担。

## 二、面向服务架构

为了解决上面这些问题，很早就有人提出来，必须打破代码的耦合，拆分单体架构，将软件拆分成一个个独立的功能单元。

大概在20多年前，随着互联网的出现，功能单元可以用远程“服务”的形式提供，就诞生出了“面向服务架构”（service-oriented architecture，简称 SOA）。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042804.webp)

所谓服务（service），就是在后台不间断运行、提供某种功能的一个程序。最常见的服务就是 Web 服务，通过80端口向外界提供网页访问。

“面向服务架构”就是把一个大型的单体程序，拆分成一个个独立服务，也就是较小的程序。每个服务都是一个独立的功能单元，承担不同的功能，服务之间通过通信协议连在一起。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042805.webp)

这种架构有很多优点。

> （1）每种服务功能单一，相当于一个小型软件，便于开发和测试。
> 
> （2）各个服务独立运行，简化了架构，提高了可靠性。
> 
> （3）鼓励和支持代码重用，同一个服务可以用于多种目的。
> 
> （4）不同服务可以单独开发和部署，便于升级。
> 
> （5）扩展性好，可以容易地加机器、加功能，承受高负载。
> 
> （6）不容易出现单点故障。即使一个服务失败了，不会影响到其他服务。

跟单体架构不一样，面向服务架构是语言不敏感的，不同服务可以使用不同的语言和工具开发，可能需要部署在不同的系统和环境。

这意味着，**面向服务架构默认运行在不同服务器上**，每台服务器提供一种服务，多台服务器共同组成一个完整的网络应用。

## 三、微服务

2014年，[Docker](https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html) 出现了，彻底改变了软件开发的面貌。它让程序运行在容器中，每个容器可以分别设定运行环境，并且只占用很少的系统资源。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042806.webp)

显而易见，可以用容器来实现“面向服务架构”，每个服务不再占用一台服务器，而是占用一个容器。

这样就不需要多台服务器了，最简单的情况下，本机运行多个容器，只用一台服务器就实现了面向服务架构，这在以前是做不到的。这种实现方式就叫做微服务。

![](https://cdn.beekka.com/blogimg/asset/220204/bg2022042807.webp)

简单说，**微服务就是采用容器技术的面向服务架构**。它依然使用“服务”作为功能单元，但是变成了轻量级实现，不需要新增服务器，只需要新建容器（一个进程），所以才叫做“微服务”。

**一个微服务就是一个独立的[进程](https://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html)。** 这个进程可以运行在本机，也可以运行在别的服务器，或者在云端（比如云服务和云函数 FaaS）。

它的特点与面向服务架构是一样的，但因为更轻量级，所以功能的解耦和服务化可以做得更彻底。而且，它可以标准化，同样的容器不管在哪里运行，结果都是一样的，所以市场上有很多 SaaS 产品，提供标准化的微服务。

正是由于微服务这些突出的优点，这几年才会变得如此流行。它和容器技术、云服务一起，一定会在未来的软件开发中，扮演越来越重要的角色。

（完）

https://www.backblaze.com/blog/what-are-microservices/