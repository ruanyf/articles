## 本周话题：为什么软件变得复杂

我一直觉得，软件开发的最大关注点，就是避免复杂性。软件设计应该越简单越好，太多的程序员以构建复杂的解决方案为荣。

但是，这个星期有一篇文章，让我意识到，我的想法是不现实的：**软件肯定会越变越复杂。**

（一）

这篇文章作者是 Saleforce 公司的前端工程师诺拉·劳森（Nolan Lawson），题目就叫做[《复杂软件的崩溃》](https://nolanlawson.com/2022/06/09/the-collapse-of-complex-software/)（下图）。

![](https://cdn.beekka.com/blogimg/asset/202206/bg2022061407.webp)

大家可能知道，Salesforce 是一家世界级软件公司，专门开发企业软件，以产品复杂而闻名。

![](https://cdn.beekka.com/blogimg/asset/202206/bg2022061406.webp)

所以，这件事情很讽刺。一家出产复杂软件的公司，自家的著名程序员公开说，复杂软件会崩溃。

当然，他在文章里面没提 Salesforce 的名字，但是怎么读都像是在写亲身经历。下面是他原文的配图和摘录。

![](https://cdn.beekka.com/blogimg/asset/202206/bg2022061408.webp)

> “任何在科技行业工作足够长的人，尤其是在大公司工作的人，都曾见过下面的场景。
> 
> 有一个遗留系统，很大很复杂，没有人完全理解它是如何工作的。
> 
> 架构师被要求“修复”系统，他们找来一块大的白板，把这个大系统分解成很多方框和箭头。对于遇到的问题，他们的解决方案就是……添加更多方框和箭头。没有任何一个可以从系统中消去，每个人都只是加上自己的那部分。

这一段是不是写得很形象，就像是日常场景的描述。

根据他的描述，我猜想，Saleforce 内部的情况大概是这样的。

> 1. 客户的需求非常复杂。为了满足这些需求，大型软件不可避免要考虑各种情况。
> 1. 软件公司的管理者真正在意的不是系统的复杂性，而是利润。只要软件能赚钱，高层并不在意软件变得复杂。
> 1. 软件复杂性都落到少数架构师和高级程序员的头上。每个人加上自己的解决方案（方框和箭头），让软件越来越复杂，然后不可避免地，他们就会在一段时间后离开公司。
> 1. 复杂系统最终变得难以理解和维护，唯一的解决方法就是放弃旧系统，从头开始写一个新系统。

所以，诺拉·劳森的文章结论很悲观：**怎么解决软件的复杂性？解决不了，最后就是你走人，公司把软件推倒重来。**

这就是一个大厂高级程序员的真实想法。国内的情况其实差不多，上面的流程完全适用于描述 BAT 内部的复杂系统。

（二）

诺拉·劳森还说了一个观点，我觉得很值得注意：**复杂软件的崩溃，往往发生在经济下行期。**

因为经济繁荣时期，各种需求大量出现，软件会快速扩张、增加功能，导致复杂度上升。软件公司会在这时大量雇佣新员工，投入更多的财力和人力，支撑复杂系统。

一旦经济进入下行期，软件失去了大量需求，公司开始冻结招聘或裁员，复杂系统就会因为突然减少的投入，在这个时候变得难以维护。

现在就是经济下行期，会不会接下来就是软件故障的高发期？

===

https://news.ycombinator.com/item?id=31688436

（1）软件复杂性的来源是，我们对软件系统的期望比以往任何时候都复杂得多。它总是变得更加复杂，需求和愿望只会增加。

（2）有些开发人员喜欢构建复杂的结构，挑战自己，获取成就感。

（3）理论上，复杂系统是由一个复杂的、运作良好的、理性的组织管理的。在实践中它不起作用，原因有很多。业务驱动软件开发，而业务正在寻求利润。企业管理者真正在意的不是系统的复杂性，而是利润，只要能持续获得利润，他并不在意系统是复杂的，还是简单的。最终，软件复杂性都落到少数架构师和高级开发人员的头上，不可避免地，人们会在一段时间后离开组织。

https://news.ycombinator.com/item?id=31685329

软件复杂性的来源：

（1）开发者创建项目的时候没有经验，对项目也不够了解，没有事先周密准备就开始构建。

（2）由于业务需求变化，导致开发事先没有预计或计划过的功能，并尽可能快地构建。这会导致开发人员走捷径，做出不优雅且难以维护的设计选择。原始开发人员离开公司后，他留下了难以理解的代码，后面接手的程序员不敢或无法修改，软件又被用来赚钱，就形成了技术债务，时间拖得越久，问题变得越复杂。

（3）团队流动性高，开发人员不断变更，很多开发工作半途而废，或者由不同的人接手。

https://news.ycombinator.com/item?id=31683204

日本的[伊势神宫](https://zh.wikipedia.org/zh-cn/%E7%A5%9E%E5%AE%AB%E5%BC%8F%E5%B9%B4%E8%BF%81%E5%AE%AB)，据说每过20年，就拆掉重新建造，为的是让建造宫殿的知识不要被忘记，能够一直传下去。历史上，伊势神宫已经重建了62次，上一次重建是2013年。

[谷歌工程师](https://arxiv.org/pdf/1702.01715.pdf)透露，谷歌的大多数软件每隔几年就会重写一次。表面上看，这样做的代价非常昂贵，消耗了谷歌的大量资源。但是，它也有一些重要的好处，能够软件始终不会偏离技术趋势和市场变化太远，防止累计技术债务，保证了公司的敏捷性和长期成功。

（1）一般来说，几年的时间会让产品需求通常会发生显着变化。几年前的软件是围绕一组较旧的需求设计的，跟现在的需求通常不是以最适合当前需求的方式设计的。

（2）重写代码消除了不必要的累积复杂性，因为复杂性是不断累积的。很多需求在开发时只是一种预估，等到开发完成时，你可能发现根本不是那么一回事，要么没有使用最合适的方法解决这个问题，要么修改代码，适合实际的需求。当你重写软件时，你已经知道现实情况是什么样了，就会用更简单的方法处理，这样就消除了复杂性。

